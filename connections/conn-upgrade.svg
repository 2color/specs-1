<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="593px" preserveAspectRatio="none" style="width:865px;height:593px;" version="1.1" viewBox="0 0 865 593" width="865px" zoomAndPan="magnify"><defs><filter height="300%" id="f1op7f28exsosw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="344" y1="53.2969" y2="364.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="344" x2="344" y1="364.3594" y2="405.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="344" y1="405.1641" y2="536.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="486" x2="486" y1="53.2969" y2="364.3594"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="486" x2="486" y1="364.3594" y2="405.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="486" x2="486" y1="405.1641" y2="536.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="312" y="49.9951">Initiator</text><ellipse cx="344" cy="21" fill="#FEFECE" filter="url(#f1op7f28exsosw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="332" x2="356" y1="35" y2="35"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="312" y="548.5576">Initiator</text><ellipse cx="344" cy="567.8594" fill="#FEFECE" filter="url(#f1op7f28exsosw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="332" x2="356" y1="581.8594" y2="581.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="444" y="49.9951">Responder</text><ellipse cx="486" cy="21" fill="#FEFECE" filter="url(#f1op7f28exsosw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="474" x2="498" y1="35" y2="35"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="444" y="548.5576">Responder</text><ellipse cx="486" cy="567.8594" fill="#FEFECE" filter="url(#f1op7f28exsosw)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="474" x2="498" y1="581.8594" y2="581.8594"/><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="858" x="0" y="83.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="83.8633" y2="83.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="86.8633" y2="86.8633"/><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="246" x="306" y="73.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="227" x="312" y="89.3638">Initial multistream handshake</text><polygon fill="#A80036" points="355,123.5625,345,127.5625,355,131.5625,351,127.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="485" y1="127.5625" y2="127.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="361" y="122.4966">/multistream/1.0.0</text><polygon fill="#A80036" points="474,152.6953,484,156.6953,474,160.6953,478,156.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="480" y1="156.6953" y2="156.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="351" y="151.6294">/multistream/1.0.0</text><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="858" x="0" y="185.2617"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="185.2617" y2="185.2617"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="188.2617" y2="188.2617"/><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="233" x="312.5" y="174.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214" x="318.5" y="190.7622">Negotiate security protocol</text><polygon fill="#A80036" points="474,229.9609,484,233.9609,474,237.9609,478,233.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="480" y1="233.9609" y2="233.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="351" y="228.895">/tls/1.0.0</text><path d="M99,212.8281 L99,237.8281 L335,237.8281 L335,222.8281 L325,212.8281 L99,212.8281 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M325,212.8281 L325,222.8281 L335,222.8281 L325,212.8281 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="105" y="229.895">Initiator proposes TLS for security</text><polygon fill="#A80036" points="355,269.0938,345,273.0938,355,277.0938,351,273.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="485" y1="273.0938" y2="273.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="361" y="268.0278">na</text><path d="M491,251.9609 L491,276.9609 L746,276.9609 L746,261.9609 L736,251.9609 L491,251.9609 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M736,251.9609 L736,261.9609 L746,261.9609 L736,251.9609 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="497" y="269.0278">Responder does not support TLS yet</text><polygon fill="#A80036" points="474,308.2266,484,312.2266,474,316.2266,478,312.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="480" y1="312.2266" y2="312.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="351" y="307.1606">/noise</text><path d="M146,291.0938 L146,316.0938 L335,316.0938 L335,301.0938 L325,291.0938 L146,291.0938 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M325,291.0938 L325,301.0938 L335,301.0938 L325,291.0938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="152" y="308.1606">Initiator falls back to Noise</text><polygon fill="#A80036" points="355,347.3594,345,351.3594,355,355.3594,351,351.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="485" y1="351.3594" y2="351.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="361" y="346.2935">/noise</text><path d="M491,330.2266 L491,355.2266 L839,355.2266 L839,340.2266 L829,330.2266 L491,330.2266 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M829,330.2266 L829,340.2266 L839,340.2266 L829,330.2266 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327" x="497" y="347.2935">Responder supports Noise, echoes back protocol id</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="366" y="388.5698">Noise handshake</text><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="858" x="0" y="425.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="425.7305" y2="425.7305"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="858" y1="428.7305" y2="428.7305"/><rect fill="#EEEEEE" filter="url(#f1op7f28exsosw)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="246" x="306" y="415.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="227" x="312" y="431.231">Negotiate stream multiplexer</text><polygon fill="#A80036" points="474,470.4297,484,474.4297,474,478.4297,478,474.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="344" x2="480" y1="474.4297" y2="474.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="351" y="469.3638">/mplex/1.0.0</text><path d="M5,453.2969 L5,478.2969 L335,478.2969 L335,463.2969 L325,453.2969 L5,453.2969 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M325,453.2969 L325,463.2969 L335,463.2969 L325,453.2969 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="11" y="470.3638">Initiator proposes mplex for stream multiplexing</text><polygon fill="#A80036" points="355,509.5625,345,513.5625,355,517.5625,351,513.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="349" x2="485" y1="513.5625" y2="513.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="361" y="508.4966">/mplex/1.0.0</text><path d="M491,492.4297 L491,517.4297 L844,517.4297 L844,502.4297 L834,492.4297 L491,492.4297 " fill="#FBFB77" filter="url(#f1op7f28exsosw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M834,492.4297 L834,502.4297 L844,502.4297 L834,492.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332" x="497" y="509.4966">Responder supports mplex, echoes back protocol id</text><!--MD5=[a7e71cb68bb057e4e39a487141de6f35]
@startuml
entity Initiator
entity Responder

== Initial multistream handshake ==

Responder -> Initiator: /multistream/1.0.0
Initiator -> Responder: /multistream/1.0.0

== Negotiate security protocol ==

Initiator -> Responder: /tls/1.0.0
note left: Initiator proposes TLS for security

Responder -> Initiator: na
note right: Responder does not support TLS yet

Initiator -> Responder: /noise
note left: Initiator falls back to Noise

Responder -> Initiator: /noise
note right: Responder supports Noise, echoes back protocol id

... Noise handshake ...

== Negotiate stream multiplexer ==

Initiator -> Responder: /mplex/1.0.0
note left: Initiator proposes mplex for stream multiplexing

Responder -> Initiator: /mplex/1.0.0
note right: Responder supports mplex, echoes back protocol id
@enduml

PlantUML version 1.2021.5beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>