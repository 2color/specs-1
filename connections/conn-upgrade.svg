<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="594px" preserveAspectRatio="none" style="width:843px;height:594px;" version="1.1" viewBox="0 0 843 594" width="843px" zoomAndPan="magnify"><defs><filter height="300%" id="fvom0cl44ilum" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="333" y1="51.4883" y2="363.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="333" x2="333" y1="363.9727" y2="404.9277"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="333" y1="404.9277" y2="536.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="479" x2="479" y1="51.4883" y2="363.9727"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="479" x2="479" y1="363.9727" y2="404.9277"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="479" x2="479" y1="404.9277" y2="536.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="310" y="48.5352">Dialer</text><ellipse cx="333" cy="19" fill="#FEFECE" filter="url(#fvom0cl44ilum)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="321" x2="345" y1="33" y2="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="310" y="549.3945">Dialer</text><ellipse cx="333" cy="568.3477" fill="#FEFECE" filter="url(#fvom0cl44ilum)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="321" x2="345" y1="582.3477" y2="582.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="449" y="48.5352">Listener</text><ellipse cx="479" cy="19" fill="#FEFECE" filter="url(#fvom0cl44ilum)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="467" x2="491" y1="33" y2="33"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="449" y="549.3945">Listener</text><ellipse cx="479" cy="568.3477" fill="#FEFECE" filter="url(#fvom0cl44ilum)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="467" x2="491" y1="582.3477" y2="582.3477"/><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="828" x="3" y="82.1436"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="82.1436" y2="82.1436"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="85.1436" y2="85.1436"/><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="221" x="306.5" y="71.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="312.5" y="88.0566">Initial multistream handshake</text><polygon fill="#A80036" points="344,122.1094,334,126.1094,344,130.1094,340,126.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="478" y1="126.1094" y2="126.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="350" y="121.3672">/multistream/1.0.0</text><polygon fill="#A80036" points="467,151.4199,477,155.4199,467,159.4199,471,155.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="473" y1="155.4199" y2="155.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="340" y="150.6777">/multistream/1.0.0</text><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="828" x="3" y="184.0752"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="184.0752" y2="184.0752"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="187.0752" y2="187.0752"/><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="200" x="317" y="173.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="323" y="189.9883">Negotiate security protocol</text><polygon fill="#A80036" points="467,229.041,477,233.041,467,237.041,471,233.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="473" y1="233.041" y2="233.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="340" y="228.2988">/tls/1.0.0</text><path d="M102,211.7305 L102,236.7305 L324,236.7305 L324,221.7305 L314,211.7305 L102,211.7305 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M314,211.7305 L314,221.7305 L324,221.7305 L314,211.7305 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="108" y="229.2988">Dialer proposes TLS for security</text><polygon fill="#A80036" points="344,268.3516,334,272.3516,344,276.3516,340,272.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="478" y1="272.3516" y2="272.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="15" x="350" y="267.6094">na</text><path d="M484,251.041 L484,276.041 L716,276.041 L716,261.041 L706,251.041 L484,251.041 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M706,251.041 L706,261.041 L716,261.041 L706,251.041 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="490" y="268.6094">Listener does not support TLS yet</text><polygon fill="#A80036" points="467,307.6621,477,311.6621,467,315.6621,471,311.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="473" y1="311.6621" y2="311.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="340" y="306.9199">/secio/1.0.0</text><path d="M143,290.3516 L143,315.3516 L324,315.3516 L324,300.3516 L314,290.3516 L143,290.3516 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M314,290.3516 L314,300.3516 L324,300.3516 L314,290.3516 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="149" y="307.9199">Dialer falls back to SECIO</text><polygon fill="#A80036" points="344,346.9727,334,350.9727,344,354.9727,340,350.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="478" y1="350.9727" y2="350.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="350" y="346.2305">/secio/1.0.0</text><path d="M484,329.6621 L484,354.6621 L815,354.6621 L815,339.6621 L805,329.6621 L484,329.6621 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M805,329.6621 L805,339.6621 L815,339.6621 L805,329.6621 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="490" y="347.2305">Listener supports SECIO, echoes back protocol id</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="93" x="359.5" y="388.6074">SECIO handshake</text><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="828" x="3" y="425.583"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="425.583" y2="425.583"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="831" y1="428.583" y2="428.583"/><rect fill="#EEEEEE" filter="url(#fvom0cl44ilum)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="216" x="309" y="414.9277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="198" x="315" y="431.4961">Negotiate stream multiplexer</text><polygon fill="#A80036" points="467,470.5488,477,474.5488,467,478.5488,471,474.5488" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333" x2="473" y1="474.5488" y2="474.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="340" y="469.8066">/mplex/1.0.0</text><path d="M8,453.2383 L8,478.2383 L324,478.2383 L324,463.2383 L314,453.2383 L8,453.2383 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M314,453.2383 L314,463.2383 L324,463.2383 L314,453.2383 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="14" y="470.8066">Dialer proposes mplex for stream multiplexing</text><polygon fill="#A80036" points="344,509.8594,334,513.8594,344,517.8594,340,513.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338" x2="478" y1="513.8594" y2="513.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="350" y="509.1172">/mplex/1.0.0</text><path d="M484,492.5488 L484,517.5488 L817,517.5488 L817,502.5488 L807,492.5488 L484,492.5488 " fill="#FBFB77" filter="url(#fvom0cl44ilum)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M807,492.5488 L807,502.5488 L817,502.5488 L807,492.5488 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="490" y="510.1172">Listener supports mplex, echoes back protocol id</text><!--
@startuml

entity Dialer
entity Listener

== Initial multistream handshake ==

Listener -> Dialer: /multistream/1.0.0
Dialer -> Listener: /multistream/1.0.0

== Negotiate security protocol ==

Dialer -> Listener: /tls/1.0.0
note left: Dialer proposes TLS for security

Listener -> Dialer: na
note right: Listener does not support TLS yet

Dialer -> Listener: /secio/1.0.0
note left: Dialer falls back to SECIO

Listener -> Dialer: /secio/1.0.0
note right: Listener supports SECIO, echoes back protocol id

... SECIO handshake ...

== Negotiate stream multiplexer ==

Dialer -> Listener: /mplex/1.0.0
note left: Dialer proposes mplex for stream multiplexing

Listener -> Dialer: /mplex/1.0.0
note right: Listener supports mplex, echoes back protocol id


@enduml

PlantUML version 1.2019.05(Sat Apr 20 12:45:36 EDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_201-b09
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>